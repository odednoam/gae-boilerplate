{% extends "base.html" %}

{% block header %}
    <div data-role="header">
        <h1>{{ lang.menu_login }}</h1>
        <i class="icon-home"></i>
        <a href="/" class="" data-role="button" data-icon="home" data-iconpos="notext">{{ lang.menu_home }}</a>
    </div>
{% endblock %}

{% block content %}
    <form id="form_login_user" action="{{ action }}" method="post" class="ui-body ui-body-c well">

        <div data-role="fieldcontain">
            <label for="username">{{ lang.login_username }}:</label>
            <input type="text" name="username" id="username" placeholder="{{ lang.enter_your }} {{ lang.login_username }}" class="required" />
        </div>

        <div data-role="fieldcontain">
            <label for="password">{{ lang.login_password }}:</label>
            <input type="password" name="password" id="password" placeholder="{{ lang.enter_your }} {{ lang.field_password }}" class="required" />
        </div>

        <div data-role="fieldcontain">
            <label for="remember_me">{{ lang.login_remember }}:</label>
            <select name="remember_me" id="remember_me" data-role="slider">
                <option value="off">No</option>
                <option value="on">{{ lang.login_yes }}</option>
            </select>
        </div>

        <button type="submit" class="btn btn-primary" data-theme="b" aria-disabled="false">{{ lang.menu_login }}</button>

    </form>

    <ul data-role="listview" data-divider-theme="b" data-inset="true" class="nav nav-tabs nav-stacked">
        <li data-role="list-divider" role="heading">
            {{ lang.menu_components }}
        </li>
        <li data-theme="c">
            <a href="/create" data-transition="slide">
                {{ lang.menu_create_user }}
            </a>
        </li>
        <li data-theme="c">
            <a href="/password/reset" data-transition="slide">
                {{ lang.menu_fyp }}
            </a>
        </li>
        <li data-theme="c">
            <a href="/google-login" data-transition="slide">
                {{ lang.menu_glogin }}
            </a>
        </li>
    </ul>
{% endblock %}

{% block mediaJS %}
    <script type="text/javascript">
        $().ready(function() {

            $("#form_login_user").validate({
                submitHandler: function(form) {
                    /*
                     * The real password never will be on the air.
                     * Hashed: to avoid rehash the password clicking on submit again.
                     * */
                    // TODO: implement this second layer of security,
                    // it sometimes encrypt the password
//                     var pwd = $("#password");
//                    if ( pwd.val() != "" && pwd.attr("hashed") != "true" ){
//                        var md5 = MD5(pwd.val());
//                        console.log(pwd.val() + " -> " + md5 );
//                        pwd.val(md5).attr("hashed", "true");
                        form.submit();
//                    }

                }
            });
        });
    </script>
{% endblock %}